CREATE OR REPLACE PROCEDURE EMPOWER.company_name_update 
AS 
p_action_msg VARCHAR2 (100);
p_sqlcode VARCHAR2 (100); p_sqlerrm VARCHAR2 (100); 
BEGIN 
FOR xx IN (SELECT * FROM ( select * from EMPOWER.EMP_CMPNY_ASSGNMNT_STAGING where UPDATE_YN ='P' 
AND SUCCESS_FLAG IS NULL ) WHERE ROWNUM <= 10) 
LOOP 
UPDATE EMPOWER.EMP_CMPNY_ASSGNMNT 
SET COMPANY_NAME = xx.NEW_COMP_NAME, LOGO_NAME = xx.NEW_COMP_NAME, UPDATED_BY='BACKENDBAUSHAN'
WHERE COMPANY_ID = xx.COMP_ID AND ACTIVE_YN='Y'; 

UPDATE EMPOWER.EMP_CMPNY_ASSGNMNT_staging SET SUCCESS_FLAG = 'S' WHERE 
COMP_ID = xx.COMP_ID; 
commit; 
END LOOP; 
EXCEPTION WHEN OTHERS 
THEN p_sqlerrm := SQLERRM; 
p_sqlcode := SQLCODE; 
p_action_msg := 'Error';
INSERT INTO emp_error_log VALUES ('company_name_update', p_action_msg, p_sqlcode, p_sqlerrm, SYSDATE); END; /
